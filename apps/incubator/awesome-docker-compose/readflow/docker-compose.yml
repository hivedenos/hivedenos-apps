version: 
 
services:
  ########################################
  # PostgreSQL
  ########################################
  db:
    image: postgres:14
    restart: always
    environment:
      - POSTGRES_DB=${POSTGRES_DB:-readflow}
      - POSTGRES_USER=${POSTGRES_USER:-postgres}
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD:-secret}
    volumes:
      - ./db-data:/var/lib/postgresql/data
 
  ########################################
  # readflow
  ########################################
  readflow:
    #build: .
    image: 
    restart: always
    depends_on:
      - db
    ports:
      - 
    environment:
      - READFLOW_DATABASE_URI=postgres://${POSTGRES_USER:-postgres}:${POSTGRES_PASSWORD:-secret}@db/${POSTGRES_DB:-readflow}?sslmode=disable
      - READFLOW_AUTHN_METHOD=basic
      - READFLOW_AUTHN_BASIC_HTPASSWD_FILE=file:///var/local/demo.htpasswd
    volumes:
      - ${PWD}/var/demo.htpasswd:/var/local/demo.htpasswd
 
networks:
  default:
